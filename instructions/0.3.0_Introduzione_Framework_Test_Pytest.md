Introduzione del Framework di Test Pytest per cliPy
Versione: 1.0
Progetto: cliPy
Autore: AI Engineer
Obiettivo: Integrare il framework di testing pytest nel progetto e scrivere il primo test automatico per l'endpoint di health check (/). Questo stabilisce le fondamenta del nostro processo di garanzia della qualit√†.
1. Aggiornamento delle Dipendenze
Per eseguire i test su un'applicazione FastAPI, abbiamo bisogno di pytest e di un client HTTP come httpx.
Aggiorna requirements.txt:
Generated text
fastapi
uvicorn[standard]

# Testing
pytest
httpx
Use code with caution.
Text
2. Implementazione del Primo Test
Creiamo il nostro primo file di test. Segue la struttura della directory src, quindi i test per src/main.py andranno in tests/test_api/test_main.py.
Crea e popola il file tests/test_api/test_main.py:
Generated python
from fastapi.testclient import TestClient
from src.main import app

# Istanzia un client di test per l'applicazione
client = TestClient(app)


def test_read_root_health_check():
    """
    Verifica che l'endpoint di health check ('/') funzioni correttamente.
    """
    # Esegui una richiesta GET all'endpoint '/'
    response = client.get("/")

    # Verifica che la risposta abbia uno status code 200 (OK)
    assert response.status_code == 200

    # Verifica che il corpo della risposta JSON sia quello atteso
    expected_response = {"status": "ok", "project_name": "cliPy"}
    assert response.json() == expected_response
Use code with caution.
Python
3. Aggiornamento della Configurazione Docker
Per coerenza con l'ambiente operativo, ho aggiornato la porta nel file docker-compose.yml alla 8019, come da te implementato.
Aggiorna docker-compose.yml:
Generated yaml
version: '3.8'

services:
  app:
    build: .
    container_name: clipy_app
    ports:
      # Aggiornato per riflettere la porta 8019
      - "8019:8000" 
    volumes:
      - ./src:/app/src
    command: uvicorn src.main:app --host 0.0.0.0 --port 8000 --reload